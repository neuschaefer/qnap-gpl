<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
        <TITLE>apcaccess</TITLE>
        <META NAME="CHANGEDBY" CONTENT="Kern Sibbald">
                <link rel=stylesheet href="apcupsd-styles.css" type="text/css">
</HEAD>
<BODY>
<H1>apcaccess</H1>
<P>Apcaccess is a program (normally found in <B>/sbin/apcaccess</B>)
that permits you to print out the complete status of your UPS.
Although there are a number of command line arguments (<B> eprom, reconfig,
status, slave, shutdown</B>), all except <b>eprom</b> and <B>status</B> are under
development and hence do not work. 
</P>
<p>If you have built <b>apcupsd</b> with pthreads enabled, <b>apcaccess</b>
will use the Network Information Server to obtain the necessary information
for the <b>status</b> and <b>eeprom</b> commands. This is because in the
pthreaded version, there is no IPC shared memory. In this case (pthreads 
enabled), you can specify a second optional argument to <b>apcaccess</b> in the
form of host:port, where the :port is optional. The default is <b>localhost:3551</b>.
Please note that in versions prior to 3.10.6, the default NIS port was
7000, so if you are mixing versions, you will need to take a lot of care
to ensure that all components are using the same port.

<h2>apcaccess status</h2>
<P>The <B>status</B> command line option of <b>apcaccess</b>
will produce a full printout of all the <B>STATUS</B>
variables used by <b>apcupsd</b>. This can be very helpful for checking the
condition of your UPS and to know whether or not <b>apcupsd</b> is properly
connected to it. For a complete description of the variables and
their meanings, please read the <A HREF="status.html" NAME="Apcupsd STATUS">Apcupsd
STATUS</A> document. 
</P>
<p>Please note that if you invoke <b>apcaccess</b> within the first 
30 seconds of launching <b>apcupsd</b>, you will likely get an error
message such as:
<p class="indent">

APCACCESS FATAL ERROR in apcipc.c at line 325
<br>
attach_shmarea: shared memory version mismatch
</p>
<p>This is because <b>apcupsd</b> is still in the
process of initializing the shared memory segment
used to communicate between the two processes. There
is also a small window of time after which the 
memory segment is properly initialized but before
the UPS has been completely polled. If you invoke
<b>apcaccess</b> during this period, you will get
the STATUS output, but with many of the values zero.
The solution is to wait at least 30 seconds after
starting <b>apcupsd</b> before launching <b>apcaccess</b>.
<P>To invoke apcaccess, enter: 
</P>
<p class="indent">apcaccess status </p>
<P>and for a SmartUPS 1000 <b>apcaccess</b> prints the following output: 
</P>
<PRE>
<br>
DATE     : Fri Dec 03 12:34:26 CET 1999
HOSTNAME : matou
RELEASE  : 3.7.0-beta-1
CABLE    : Custom Cable Smart
MODEL    : SMART-UPS 1000
UPSMODE  : Stand Alone
UPSNAME  : UPS_IDEN
LINEV    : 232.7 Volts
MAXLINEV : 236.6 Volts
MINLINEV : 231.4 Volts
LINEFREQ : 50.0 Hz
OUTPUTV  : 232.7 Volts
LOADPCT  :  11.4 Percent Load Capacity
BATTV    : 27.7 Volts
BCHARGE  : 100.0 Percent
MBATTCHG : 5 Percent
TIMELEFT : 112.0 Minutes
MINTIMEL : 3 Minutes
SENSE    : Low
DWAKE    : 060 Seconds
DSHUTD   : 180 Seconds
LOTRANS  : 204.0 Volts
HITRANS  : 253.0 Volts
RETPCT   : 050.0 Percent
STATFLAG : 0x08 Status Flag
STATUS   : ONLINE 
ITEMP    : 29.2 C Internal
ALARMDEL : Low Battery
LASTXFER : U command or Self Test
SELFTEST : NO
STESTI   : 336
DLOWBATT : 02 Minutes
DIPSW    : 0x00 Dip Switch
REG1     : 0x00 Register 1
REG2     : 0x00 Register 2
REG3     : 0x00 Register 3
MANDATE  : 01/05/99
SERIALNO : GS9902009459
BATTDATE : 01/05/99
NOMOUTV  : 230.0
NOMBATTV :  24.0
HUMIDITY : N/A
AMBTEMP  : N/A
EXTBATTS : 0
BADBATTS : N/A
FIRMWARE : 60.11.I
APCMODEL : IWI
END APC  : Fri Dec 03 12:34:33 CET 1999
</PRE>
<h2>apcaccess eprom</h2>
The <b>eprom</b> command line option for <b>apcaccess</b> allows you to 
examine the current values of your UPS' EPROM as well as to know the
permitted values that can be set in the EPROM. For information about
changing these values, see the section on <a href="eprom.html">Apcupsd EEPROM Configuration</a>.
<p>
A typical output from <b>apcaccess eprom</b> is:
<pre>

Valid EPROM values for the SMART-UPS 1000

                         Config        Current  Permitted
Description              Directive     Value    Values
===================================================================
Upper transfer voltage   HITRANSFER    253      253 264 271 280 
Lower transfer voltage   LOTRANSFER    208      196 188 208 204 
Return threshold         RETURNCHARGE  15       00 15 50 90 
Output voltage on batts  OUTPUTVOLTS   230      230 240 220 225 
Sensitivity              SENSITIVITY   H        H M L L 
Low battery warning      LOWBATT       2        02 05 07 10 
Shutdown grace delay     SLEEP         180      020 180 300 600 
Alarm delay              BEEPSTATE     T        0 T L N 
Wakeup delay             WAKEUP        60       000 060 180 300 
Self test interval       SELFTEST      336      336 168 ON  OFF 
</pre>
<hr>
<a href="shutdown.html" target="_self"><img src="back.gif" border=0 alt="Back"></a>
<a href="apctest.html" target="_self"><img src="next.gif" border=0 alt="Next"></a>
<a href="index.html"><img src="home.gif" border=0 alt="Home"></a>
</BODY>
</HTML>
